FROM vm/ubuntu:18.04
# To note: Layerfiles create VMs, *not* containers!

# Install Node.js
RUN curl -sL https://deb.nodesource.com/setup_12.x | bash && \
    apt install -y nodejs && \
    rm -f /etc/apt/sources.list.d/nodesource.list

# Install global dependencies
RUN npm install -g http-server

# Copy project files
COPY . .

# Install project dependencies
RUN npm install

# Run tests
RUN npm test

# Create a simple HTML file for demo purposes
RUN echo 'hello' > hello.html

# Start the HTTP server in the background
RUN BACKGROUND http-server -p 8000

# Expose the server to the outside world
EXPOSE 3000
